(function(t,n){function e(){return a?a.fn.getScrollTop():o.body.scrollTop}function i(){return a?a.offsetHeight:o.body.clientHeight}var a,o=t.document,r=t.navigator,s=r.appVersion,c=(/android/gi.test(s),/iphone|ipad/gi.test(s));n.plugin.lazyload={_options:null,_startScrollTime:0,_endScrollTime:0,_scrollFlickTime:200,_getParent:function(t){return t.offsetParent||t.parentNode},_getOffset:function(t){var e,i=n.component.getActiveContent(),r=getComputedStyle(t),s=parseFloat(t.getAttribute("height")||t.offsetHeight||r.height),c=parseFloat(t.offsetTop),u=0;if(!a)for(e=this._getParent(i);e&&e!=o.body;)u+=parseFloat(e.offsetTop),e=this._getParent(e);for(e=this._getParent(t);e&&e!=i;)c+=parseFloat(e.offsetTop||0),e=this._getParent(e);return{top:c+u,bottom:c+s+u}},_checkStart:function(){this._startScrollTime=Date.now()},_checkEnd:function(){var t=this;if(this._endScrollTime=Date.now(),this._endScrollTime-this._startScrollTime<this._scrollFlickTime)if(c)window.addEventListener("scroll",this.check);else var n=o.body.scrollTop,e=setInterval(function(){n===o.body.scrollTop?(clearInterval(e),t.check()):n=o.body.scrollTop},50);else this.check()},check:function(){for(var t=this._options,a=t.page.dataAttr||"data-src",o=n.component.getActiveContent(),r=o.querySelectorAll("img["+a+"]"),s=e(),c=e()+i(),u=0;r.length>u;u++){var l,d=r[u],f=this._getOffset(d);(f.top>s&&c>f.top||f.bottom>s&&c>f.bottom)&&(l=d.getAttribute(a),l&&(d.setAttribute("src",l),d.removeAttribute(a)))}},on:function(t,e){this._options=e,a=n.component.get("scroll"),this._checkStart=this._checkStart.bind(this),this._checkEnd=this._checkEnd.bind(this),this.check=this.check.bind(this),a?n.component.on("scrollEnd",this.check):(o.addEventListener("touchstart",this._checkStart,!1),o.addEventListener("touchend",this._checkEnd,!1))},off:function(){a?n.component.off("scrollEnd",this.check):(o.removeEventListener("touchstart",this._checkStart,!1),o.removeEventListener("touchend",this._checkEnd,!1))}}})(window,window.app);