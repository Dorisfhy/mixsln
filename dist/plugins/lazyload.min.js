(function(t,e){function n(){return a?a.fn.getScrollTop():o.body.scrollTop}function i(){return a?a.offsetHeight:o.body.clientHeight}var a,o=t.document,r=t.navigator,c=r.appVersion,s=(/android/gi.test(c),/iphone|ipad/gi.test(c));e.plugin.lazyload={_options:null,_startScrollTime:0,_endScrollTime:0,_scrollFlickTime:200,_getParent:function(t){return t.offsetParent||t.parentNode},_getOffset:function(t){var n,i=e.component.getActiveContent(),r=getComputedStyle(t),c=parseFloat(t.getAttribute("height")||t.offsetHeight||r.height),s=parseFloat(t.offsetTop),l=0;if(!a)for(n=this._getParent(i);n&&n!=o.body;)l+=parseFloat(n.offsetTop),n=this._getParent(n);for(n=this._getParent(t);n&&n!=i;)s+=parseFloat(n.offsetTop||0),n=this._getParent(n);return{top:s+l,bottom:s+c+l}},_checkStart:function(){this._startScrollTime=Date.now()},_checkEnd:function(){var t=this;if(this._endScrollTime=Date.now(),this._endScrollTime-this._startScrollTime<this._scrollFlickTime)if(s)window.addEventListener("scroll",this.check);else var e=o.body.scrollTop,n=setInterval(function(){e===o.body.scrollTop?(clearInterval(n),t.check()):e=o.body.scrollTop},50);else this.check()},check:function(){for(var t=this._options,a=t.page.dataAttr||"data-src",o=e.component.getActiveContent(),r=o.querySelectorAll("img["+a+"]"),c=n(),s=n()+i(),l=0;r.length>l;l++){var u,f=r[l],h=this._getOffset(f);(h.top>c&&s>h.top||h.bottom>c&&s>h.bottom)&&(u=f.getAttribute(a),u&&(f.setAttribute("src",u),f.removeAttribute(a)))}},on:function(t,n){this._options=n,a=e.component.get("scroll"),this._checkStart=this._checkStart.bind(this),this._checkEnd=this._checkEnd.bind(this),this.check=this.check.bind(this),a?e.component.on("scrollEnd",this.check):(o.addEventListener("touchstart",this._checkStart,!1),o.addEventListener("touchend",this._checkEnd,!1))},off:function(){a?e.component.off("scrollEnd",this.check):(o.removeEventListener("touchstart",this._checkStart,!1),o.removeEventListener("touchend",this._checkEnd,!1))}}})(window,window.app);