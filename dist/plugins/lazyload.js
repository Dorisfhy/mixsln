(function(a,b){function e(){return d?d.fn.getScrollTop():c.body.scrollTop}function g(){return d?d.offsetHeight:c.body.clientHeight}var d,c=a.document;b.plugin.lazyload={_options:null,_startScrollTime:0,_endScrollTime:0,_scrollFlickTime:200,_getParent:function(a){return a.offsetParent||a.parentNode},_getOffset:function(a){var h,e=b.component.getActiveContent(),f=getComputedStyle(a),g=parseFloat(a.getAttribute("height")||a.offsetHeight||f.height),i=parseFloat(a.offsetTop),j=0;if(!d)for(h=this._getParent(e);h!=c.body;)j+=parseFloat(h.offsetTop),h=this._getParent(h);for(h=this._getParent(a);h!=e;)i+=parseFloat(h.offsetTop),h=this._getParent(h);return{top:i+j,bottom:i+g+j}},_checkStart:function(){this._startScrollTime=Date.now()},_checkEnd:function(){this._endScrollTime=Date.now(),this._endScrollTime-this._startScrollTime<this._scrollFlickTime?setTimeout(this.check,100):this.check()},_check:function(){for(var a=this._options,c=a.page.dataAttr||"data-src",d=b.component.getActiveContent(),f=d.querySelectorAll("img["+c+"]"),h=e(),i=e()+g(),j=0;f.length>j;j++){var m,k=f[j],l=this._getOffset(k);(l.top>h&&i>l.top||l.bottom>h&&i>l.bottom)&&(m=k.getAttribute(c),m&&(k.setAttribute("src",m),k.removeAttribute(c)))}},check:function(){var a=this;setTimeout(function(){a._check()},500)},on:function(a,e){this._options=e,d=b.component.get("scroll"),this._checkStart=this._checkStart.bind(this),this._checkEnd=this._checkEnd.bind(this),this.check=this.check.bind(this),d?b.component.on("scrollEnd",this.check):(c.addEventListener("touchstart",this._checkStart,!1),c.addEventListener("touchend",this._checkEnd,!1))},off:function(){d?b.component.off("scrollEnd",this.check):(c.removeEventListener("touchstart",this._checkStart,!1),c.removeEventListener("touchend",this._checkEnd,!1))}}})(window,window.app);